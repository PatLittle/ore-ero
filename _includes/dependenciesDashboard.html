<section>
    
    <div class=row>
        <details open>
          <summary><h4 class="h4">{{ site.data.i18n.tables.filterOptions[page.lang] }}</h4></summary>
          <form class="wb-tables-filter" data-bind-to="dataset-filter">

        <div class=row>
            <div class="form-group col-md-6">
              <label for="dt_govLevel">{{ site.data.i18n.form.presets.orgLevel.title[page.lang] }}</label>
              <select class="form-control" id="dt_govLevel" name="dt_govLevel" data-column="5">
                <option value="">&nbsp;</option>
                {%- for govLevel in site.data.i18n.administrations -%}
                <option value="{{ govLevel[1].value }}">{{ govLevel[1][page.lang] }}</option>
                {%- endfor -%}
              </select>
            </div>
      
        </div>
        <div class="row">
            <div class="form-group col-md-6">
              <label for="dt_department">{{ site.data.i18n.tables.administrations[page.lang] }}</label>
              <select class="form-control" id="dt_department" name="dt_department" data-column="0">
                <option value="">&nbsp;</option>
                {%- assign admin_arr = "" | split: ',' -%}
                {%- for govLevels in site.data.code -%}
                  {%- assign govLevel = govLevels[0] -%}
                  {% for admin in govLevels[1] %}
                    {%- assign administration = site.data.administrations[govLevel] | where: "code", admin[0] -%}
                    {%- assign admin_arr = admin_arr | push: administration[0].name[page.lang] -%}
                  {% endfor %}
                {%- endfor -%}
                {%- assign admin_arr = admin_arr | sort -%}
                {%- for admin in admin_arr -%}
                  <option value="{{ admin }}">{{ admin }}</option>
                {%- endfor -%}
              </select>
            </div>

            <div class="form-group col-md-6">
                <label for="dt_name">{{ site.data.i18n.tables.projectName[page.lang] }}</label>
                <select class="form-control" id="dt_name" name="dt_name" data-column="1">
                  <option value="">&nbsp;</option>
                  {%- assign name_arr = "" | split: ',' -%}
                  {%- for govLevels in site.data.dependencies -%}
                    {%- for admin in govLevels[1] -%}
                      {%- for releases in admin[1] -%}
                      {%- for dependencySet in releases[1] -%}
                      {%- if dependencySet.name != nil -%}
                      {%- assign name_arr = name_arr | push: dependencySet.name[page.lang] -%}
                      {%- endif -%}
                      {%- endfor -%}
                      {%- endfor -%}
                    {%- endfor -%}
                  {%- endfor -%}
                  {%- for name in name_arr -%}
                  <option value="{{ name }}">{{ name }}</option>
                  {%- endfor -%}
                  </select>
              </div>
        </div>
        <div class="row">
            <div class="form-group col-md-6">
              <label for="dt_team">{{ site.data.i18n.tables.dependencyType[page.lang] }}</label>
              <select class="form-control" id="dt_type" name="dt_type" data-column="3">
                <option value="">&nbsp;</option>
                <option value="core">core</option>
                <option value="dev">dev</option>
                <option value="peer">peer</option>
                </select>
            </div>
      
            <div class="form-group col-md-6">
              <label for="dt_category">{{ site.data.i18n.tables.dependencyOrigin[page.lang] }}</label>
              <select class="form-control" id="dt_origin" name="dt_origin" data-column="4">
                <option value="">&nbsp;</option>
                <option value="bundler">bundler</option>
                <option value="composer">composer</option>
                <option value="npm">npm</option>
                <option value="pypi">pypi</option> 
              </select>
            </div>
        </div>
      
            <div class="row">
              <div class="col-xs-6">
                <button type="submit" class="btn btn-primary" aria-controls="dataset-filter">{{ site.data.i18n.tables.filter[page.lang] }}</button>
              </div>
              <div class="col-xs-6">
                <button type="reset" class="btn btn-default">{{ site.data.i18n.tables.clear[page.lang] }}</button>
              </div>
            </div>
      
          </form>
        </details>
      </div>
      
      <!-- Data Table -->
      <div class="col-md-12 mrgn-bttm-lg">
        <table class="wb-tables table" id="dataset-filter" data-wb-tables='{"order": [1, "asc"], "columnDefs": [{"targets": [0, 5], "visible": false}], "paging": false}'>
          <thead>
            <tr>
              <th>{{ site.data.i18n.tables.administration[page.lang] }}</th>
              <th>{{ site.data.i18n.tables.projectName[page.lang] }}</th>
              <th>{{ site.data.i18n.tables.dependency[page.lang] }}</th>
              <th>{{ site.data.i18n.tables.dependencyType[page.lang] }}</th>
              <th>{{ site.data.i18n.tables.dependencyOrigin[page.lang] }}</th>
              <th>{{ site.data.i18n.form.presets.orgLevel.title[page.lang] }}</th>
            </tr>
          </thead>
          <tbody>
            {%- for govLevels in site.data.dependencies -%}
              {%- assign govLevel = govLevels[0] -%}
              {%- for admin in govLevels[1] -%}
                {%- for releases in admin[1] -%}
                {%- for dependencySet in releases[1] -%}
                {%- for val in dependencySet.values -%}

                <tr>
                  {%- assign administration = site.data.administrations[govLevel] | where: "code", admin[0].adminCode -%}
                  <td>{{ administration[0].name[page.lang] }}</td>
      
                  <td>{{ dependencySet[0].name[page.lang] }}</td>
                  <td>
                    {{ val }}
                  </td>
                  <td>{{ dependencySet[0].type }}</td>
                  <td>{{ dependencySet[0].origin }}</td>
                  <td>{{ site.data.i18n.administrations[govLevel].value }}</td>
                  </tr>
                  {%- endfor -%}
                  {%- endfor -%}
                {%- endfor -%}
              {%- endfor -%}
            {%- endfor -%}
          </tbody>
        </table>
      </div>
      
</section>